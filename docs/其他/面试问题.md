---
title: '面试问题'
---
# 华盛通2023-07-07 一面

## spring中的设计模式



## Aop机制

面向切面变成, 基于jdk 动态代理和cglib动态代理实现,  可以为方法指定对应的切面 ,从而动态扩展方法功能 , 比如为远程方法调用增加日志、trace.等

jdk动态代理:运行时动态代理技术, 可以实现对接口的动态代理, 实现对象的invoactionhandler 来扩展原有类中方法的功能, 底层使用代理模式,重新生成一个代理类, 在调用方法之前或者之后 加载invocationhandler里面的扩展方法,只能对方法进行动态代理,

cglib: 编译时字节码增强技术, 可以对字段、类、方法进行字节码增强

spring -aop: 对jdk动态代理、cglib进行包装, 常用的注解, @Aspect 定义切面 , @PointCut 定义切人点 ,切入点即拦截的方法位置 ,  @Around 、@Before @After 定义Advice 通知, 比如加日志、监控、上报指标等



## kafka消息积压如何处理, 加消费者后rebalance如何解决分区重分配问题

rebalance 无法避免



## redis节点挂掉如何处理

ping消息获取节点信息:

投票过程是集群中所有master参与,如果半数以上master节点与master节点通信超时(cluster-node-timeout),认为当前master节点挂掉。 

如果无对应的salve节点, 集群直接不可用

slave 节点发小master节点挂掉后,开始raft 选举, offset 最大的节点优先选举, offset比较小的延迟选举

扩展信息

kafka

​				leader follower 挂掉后也是类似的原则, 由controller节点 , 从AR 副本 (ISR) 中选取一个副本作为leader 副本

elasticesarch (bully算法)

master节点选举: activeMaster列表是其它节点认为的当前集群的Master节点列表，如果activeMasters列表不为空，elasticsearch会优先从activeMasters列表中选举，也就是对应着流程图中的蓝色框，选举的算法是Bully算法，笔者在前文中详细介绍了Bully算法，Bully算法会涉及到优先级比较， 在activeMasters列表优先级比较的时候，如果节点有成为master的资格，那么优先级比较高，如果activeMaster列表有多个节点具有master资格，那么选择id最小的节点 



## 线程池

线程数量如何规划

cpu类型的 N+1, IO密集型2N

## arraylist 、linklist插入数据时间复杂度、空间复杂度



## clickhouse物化视图实现,是否存在一致性问题





# elasticsearch

## 主分片

​			主节点负责创建索引、删除索引、分配分片、追踪集群中的节点状态等工作, bully 、raft算法选取主节点

## master节点选举

从候选节点中选择 id 最小的节点作为主节点, bully算法 

## 分片分配

​		master 节点进行分片数据分配. 通过将in-sync列表的分片遍历各个decider，如果有任一deny发生，则拒绝本次分配。决策结束之后可能会有多个节点，取第一个节点上的分片作为主分片。 (类似kafka 副本故障转移技术)







# java算法 常用函数

## list删除元素

arrays.remove();



## int[]  数组转化尽量用arraylist 

## 二叉搜索树与双向链表:https://www.nowcoder.com/practice/947f6eb80d944a84850b0538bf0ec3a5?tpId=295&tqId=23253&ru=/exam/oj&qru=/ta/format-top101/question-ranking&sourceUrl=%2Fexam%2Foj





## 是否是二叉搜索树



Array.copyOf({原数组},数组长度);



# 2023-07-10 乐信集团- 一面

## elasticsearch 数据删除之后会发生什么

标记删除,还是会存在对应的数据, es内部维护线程进行段的合并。删除后可能导致性能不降反升, 可以调用es的merge 接口手动进行的段合并

## 是否会存在大合并

## es 数据查询变慢问题排查 :

删除数据,导致cpu飙升, 可以手动进行es段的合并





## 2023-07-11 国泰产险-一面

压测如何进行 

jmeter 还是自定义、

# 2023-07-11  华盛通 二面 



# 2023-07-12 健康160一面

## ribbon负载均衡

## 限流

​	sentinel限流

​	Guava Rate limit :基于令牌桶算法

本地限流: 每个节点分配一定的流量, 查询是判断是否流量是否控制范围内,若是, 正常执行, 否的话,拒绝, 每隔一段时间拉取对应的流量, 

分布式限流: 针对并发比较小的情况

## TCC事务机制 ,事务悬挂问题

tcc 三个阶段: 

try

confirm

cancel

需要业务保证,幂等性、空回滚、事务悬挂问题

事务悬挂: 先try 、后cancel , try 后到达, 导致先进行了cancel ,try 资源被悬挂,解决方案 ,执行try的时候需要判断下是否先执行了cancel ,如果执行不用执行try了

## 范型

优势

- 类型安全,可以在编译期进行类型擦出,及时发现类型安全问题
- 使用范型,可以编写更加通用的代码,提高代码的灵活性
- 使用时,可以避免频繁类型转换

局限性:
```
无法使用基本类型作为类型参数，例如List<int>是不允许的，需要使用包装类List<Integer>代替。
无法创建具有泛型类型参数的数组，例如new T[]是不合法的，可以使用List<T>代替。

```





## elasticsearch有多少种查询方式
xxx
term查询（精准查询）
math查询（分词匹配查询）
fuzzy查询（模糊查询）
wildcard(通配符查询)
bool查询（布尔查询）

分页查询

- from + size,分页限制1万,超过会报错
- search after 利用实时有游标来帮我们解决实时滚动的问题。第一次搜索时需要指定 sort，并且保证值是唯一的，可以通过加入 _id 保证唯一性。缺点: 可以实时高效的进行分页查询，但是它只能做下一页这样的查询场景，不能随机的指定页数查询
- scroll api   创建一个快照，有新的数据写入以后,无法被查到。每次查询后，输入上一次的 scroll_id。目前官方已经不推荐使用这个API了，使用`search_after`即可。



## redis list用途

## redis 重启如何恢复数据 (rdb、aof)

​	如果同时使用RDB和AOF两种持久化机制，那么在redis重启的时候，会使用AOF来重新构建数据，因为AOF中的数据更加完整

## redis 使用注意事项

## kafka如何保证幂等性

## 创建线程的方式

- 继承thread
- 实现runnable接口
- 实现callable接口 , new FutrueTask({Callable接口实现})
- 通过线程池

# 2023-07-13  盛业一面 

500万数据多个数据组合查询,如何进行优化

大表数据字段变更

分布式锁 , 数据库实现分布式锁, 节点挂掉后, 锁会被释放掉吗?



# 2023-07-13  华润

http 常见请求头

跨域问题 

sha256

final方法 

## feign 注解 

​	@FeignClient @RequestMapping

docker compose 最佳实践 

注册中心设计: 

# 2023-07-13  after-ship (一面挂)

场景类设计题目、堆 问题 , 感觉都答的差不多, 面试官说可以过, 最终挂了, 不知道啥原因

# 2023-07-14 华盛hr面





# 2023-07-17 shein - 一面(挂) 30分钟左右

## young gc -如何进行垃圾回收 ,频繁youngc 会有什么问题

younggc 采用复制算法, 频繁younggc  cpu 会飙升

## kafka 消息堆积 ,如何解决 

调整消费者拉取数据量大小

调整提交时间间隔

消息异步化处理(提升消费速度,避免积压)

## reetranlock 、synchronized 除了实现方式还有甚么区别

锁区别, 公平锁、 非公平锁

是否可中断 ,  不可中断、可中断

手动加锁、释放  ,reentrantlock 需要在finally 里面手动释放锁, 否则会导致锁一致得不到释

condition 、wait 、notifyALL 区别

## 主动缓存里面的key是什么

接口 +  请求参数

## 大key存储问题

## 线程池停止的方式

- shutdown 
- shutdownnow 
-  awaitTermination, 请求等待一段时间后

## redis 集群模式如何感知节点变化

- lecture 开起定时更新网络结构配置 和 感知节点故障后 惰性更新配置 , 更新集群对应的不可用刷新间隔
- redission 可以自动感知集群拓扑变化

# 2023-07-17 唯品会一面 (1个小时)

## redis 集群如何实现mget 

## 二级缓存如何实现 

springcache 、caffine 、

利用redis的发布订阅模式更新本地缓存数据

caffeine-redis-sping-boot-starter

订阅db里面的数据,同步更新redis缓存, redis 中利用pub/sub机制更新本地缓存

## 什么时候需要自定义类加载器

tomcat 自定义类加载器, 可以隔离web服务下不同jar之间的版本, 每个web容器只加载相应版本的jar

# 2023-07-18 乐信二面(30分钟)

## 数据库为什么推荐用自增id作为主键索引

- 如果主键为自增 id 的话，mysql 在写满一个数据页的时候，直接申请另一个新数据页接着写就可以了。
- 如果主键是非自增 id，为了确保索引有序，mysql 就需要将每次插入的数据都放到合适的位置上。

## 身份证号码如何做索引、频繁更新

识别身份证号的关键信息 、 hash取值后做索引、 冗余一个字段做更新

## epoll 边缘触发和水平触发

zset linklist 如何保证性能不退化成链表, 有个随机数,插入节点的时候按照概率, 越少层概率越小. 使得层数尽可能的均匀

## innodb的四大特性

- 插入缓存
- 二次写
- 自适应哈希
- 预读

# 2023-07-18 健康160二面

项目问题一个个问 

如何确保微信id数据问题 



# 2023-07-19 -盛业二面 (30分钟 ,估计没戏-最后过了)



# 2023-07-19 华润二面(1个小时)

如何保证分布式事务的一致性,设计一种通用方案 ,最终消息一致性

http各版本区别 , 最新到http3.0 web3.0, 基于udp



# 2023-07-20 富图一面

## 四次挥手过程 

最有有个timewait的过程,防止ack失败的情况出现

## dns污染

## dns劫持

## dns泄漏

## dns 解析过程 :

1. 主机先向本地域名服务器进行递归查询
2. 本地域名服务器采用迭代查询，向一个根域名服务器进行查询
3. 根域名服务器告诉本地域名服务器，下一次应该查询的顶级域名服务器的IP地址
4. 本地域名服务器向顶级域名服务器进行查询
5. 顶级域名服务器告诉本地域名服务器，下一步查询权限服务器的IP地址
6. 本地域名服务器向权限服务器进行查询
7. 权限服务器告诉本地域名服务器所查询的主机的IP地址
8. 本地域名服务器最后把查询结果告诉主机

## backlog:全链接队列 ,  somaxconnection  

即全连接队列长度 = min(backlog, 内核参数 net.core.somaxconn)

队列满了容易出现丢包的情况发生

## 增大 TCP 半连接队列和全连接队列的方式

- 增大 TCP 半连接队列的方式是增大 /proc/sys/net/ipv4/tcp_max_syn_backlog；
- 增大 TCP 全连接队列的方式是增大 listen() 函数中的 backlog；

ss命令 可以查看全连接队列

如何防止syn攻击

- 增大半连接队列；
- 开启 tcp_syncookies 功能
- 减少 SYN+ACK 重传次数

## 502 错误排查

服务器作为网关, 请求上游得不到正常的返回







# 2023-07-21 -健康160三面(40分钟左右)

职业生涯规划, 整体状态不太好, 没有说明自己的远期规划是什么,后面需要特别准备下 , 尤其是ai 相关领域, 

# 2023-07-21 - 阿里lazada (一面-1个小时)

一道算法题, 求完全二叉树的最后一个节点 , 面试官比较nice ,体验很好 ,没怎么问八股文

简单问了下threadlocal

 java、 go 之间的不同

完全二叉树的最后一个节点. 

# 2023-07-24 唯品会二面(45分钟-挂)

## 索引的实现原理

- MyISAM,非聚簇索引 

- innodb 聚簇索引,底层B+树

# 2023-07-23 阿里lazada 二面(一个小时-- 要挂,面试官不按常理出牌-最后过了)

## 数据库 groupby 如何进行优化

原始groupby过程

- 临时表(内存或者磁盘) , 走索引,本身自带去重操作,就不会使用临时表了
- orderby 排序,filesort(内存,磁盘)

优化

elasticsearch 有过哪些优化

- 查询优化
- 插入优化
- 硬件配置优化
- 数据字段优化, 合理设计分词,合理使用缓存
- 服务端合理设置分片,refresh(默认1秒)、tranlog时间(默认5秒)

# 2023-07-25 - 富图

## 系统调用是什么

## 证书如何签名、如何保证安全

ca机构办法证书会对证书信息进行签名, 签名后有私钥进行加密, 浏览器内置了主流ca的公钥,可以揭秘对应的签名,采用相同的签名算法看两次签名是否一致即可

## BIO、NIO区别, 同步与异步的区别

## 如何避免死锁问题

# 2023-07-25 - oppo 一面数据平台开发

没咋准备 ,估计凉了 , 凉就凉吧 ,无所谓了 

maven的几种依赖scope , compile 、test、runtime

spark 任务

jedis 常用的配置

ast解析

join优化

clickhouse 常用的引擎

clickhouse 建表语句,skiplist

# 2023-07-26 富图三面(35分钟左右概率题没有分析出来,要凉最后过了)

概率题:  硬币空杯子概率,交换,因为交换之后的概率是2/3

中文词检索:  trie树

go cpu调度

go 内存分配机制

close-wait 如何处理

进程挂掉后 os层面的连接会如何处理

# 2023-07-26 小红书(一面1小时25分钟) 

直接来个算法设计题(不怎么会,设计完我还是蒙圈的)

interface SmartCache {
    String get(String key);
}
//不考虑set操作

1.如果key不为热点，则从DB获取
return getFromDB(key);
// getFromDB()无需代码实现

2.如果key为热点，则将DB数据缓存到本地的某个数据结构，优先从本地缓存读取

定义最近N秒内访问次数超过M的key为热点key（M和N是固定的常数）



## 消息写入redis , 如何避免热key问题

客户端规定时间批量写入

写入时给个随机数

mq 错峰写入(会有延迟)

# 2023-07-27 阿里lazada 三面

入账出账是什么意思

平台类型账号转账如何提高并发和实时性





# 2023-07-28 - oppo二面(画像)

# 2023-07-28 - 中国移动 

围着项目问

# 2023-07-30 沃尔玛(一二面)

场景设计题 ,现有模型 ,然后根据模型进行对应的技术选型 ,

考虑一些常见的问题 ,例如流量、安全 等

# 2023-07-31 小红书二面(应该是凉了-过)

给了一个算法 , 移动非0元素到最左侧 , 出了个乌龙,交换元素没搞对

# 2023-08-01 无觅-二面

资源有限的情况下,如何提升资源利用率

# 2023-08-01 oppo-三面

没问问题

# 2023-08-01- 字节一面

redis 热key问题



# 2023-08-02  平安一面

项目面试

设计

交替打印问题

有哪些还没有被发掘的点



# 2023-08-03 shopee一面

实现单链表的快速排序



# 2023-08-08 荣耀三面四面



领域设计模式

按照领域进行设计,尽可能少的减少业务影响对代码的干扰

战术设计: 边界上下文、核心子域、通用子域、支撑子域,实体、值对象

领域事件

战术设计: 用户接口层、应用层、领域层、接口层

洋葱模型、六边形架构(各种防腐层、VO、DTO、DO转换)



# 2023-08-09 小红书三面

架构变更hc调整,  到三面 没有后续了, 估计招到人了 ,不推进后续流程了



# 2023-08-09 字节(45分钟)

数组最大容量

推荐算法,如何保证推荐不重复



# 2023-08-14 -字节三面

## 项目qps 、tps 之类的,需要考虑面试者对项目的熟悉程度

## 设计一个停车场收费系统
